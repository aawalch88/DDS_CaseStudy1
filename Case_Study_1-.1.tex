\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage[margin=1in]{geometry}
\usepackage{hyperref}
\hypersetup{unicode=true,
            pdftitle={Case Study 1},
            pdfauthor={Suchismita Moharana and Andy Walch},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\providecommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}

  \title{Case Study 1}
    \pretitle{\vspace{\droptitle}\centering\huge}
  \posttitle{\par}
    \author{Suchismita Moharana and Andy Walch}
    \preauthor{\centering\large\emph}
  \postauthor{\par}
      \predate{\centering\large\emph}
  \postdate{\par}
    \date{October 11, 2019}


\begin{document}
\maketitle

\hypertarget{introduction}{%
\subsubsection{Introduction}\label{introduction}}

In this report, we explore \texttt{beers} and \texttt{breweries}
datasets for the 51 states in the US. The steps and procedures taken in
this analysis are stipulated below. We successfully merged the two
datasets \texttt{Beers} dataset which contains a list of 2410 US craft
beers to the \texttt{Breweries} dataset containing 558 US breweries.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{knitr}\OperatorTok{::}\NormalTok{opts_chunk}\OperatorTok{$}\KeywordTok{set}\NormalTok{(}\DataTypeTok{echo =} \OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(readr)}
\KeywordTok{library}\NormalTok{(plotly)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Loading required package: ggplot2
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'plotly'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:ggplot2':
## 
##     last_plot
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:stats':
## 
##     filter
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:graphics':
## 
##     layout
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(dplyr)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Attaching package: 'dplyr'
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:stats':
## 
##     filter, lag
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(ggplot2)}

\NormalTok{df_beers <-}\StringTok{ }\KeywordTok{read_csv}\NormalTok{(}\StringTok{"Beers.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Parsed with column specification:
## cols(
##   Name = col_character(),
##   Beer_ID = col_double(),
##   ABV = col_double(),
##   IBU = col_double(),
##   Brewery_id = col_double(),
##   Style = col_character(),
##   Ounces = col_double()
## )
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df_breweries <-}\StringTok{ }\KeywordTok{read.csv}\NormalTok{(}\StringTok{"Breweries.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{analysis-questions}{%
\subsubsection{Analysis Questions}\label{analysis-questions}}

In this section, we address the research questions put together on this
two dataset. The questions are numbered 1 to 7

\hypertarget{how-many-breweries-are-present-in-each-state}{%
\paragraph{1. How many breweries are present in each
state?}\label{how-many-breweries-are-present-in-each-state}}

We answer this question by using \texttt{count} function in base to
count the number of breweries grouped by ``state''. This creates a
dataframe named \texttt{df\_count} with two columns \texttt{State} which
is the State name and \texttt{Breweries} which is the number of
breweries in a given state. Each row represents one State. Colorado has
the highest number of breweries \{47\} where as Washington DC, South
Dakota (SD), North Dakota (ND), and West Virginia (WV) tie for the least
amount of breweries each with just 1.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#Code}
\NormalTok{df_count <-}\StringTok{ }\KeywordTok{count}\NormalTok{(df_breweries, df_breweries}\OperatorTok{$}\NormalTok{State, }\DataTypeTok{sort=}\OtherTok{FALSE}\NormalTok{)}
\KeywordTok{names}\NormalTok{(df_count)[}\DecValTok{1}\NormalTok{] <-}\StringTok{ "State"}
\KeywordTok{names}\NormalTok{(df_count)[}\DecValTok{2}\NormalTok{] <-}\StringTok{ "Breweries"}
\NormalTok{df_count}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 51 x 2
##    State Breweries
##    <fct>     <int>
##  1 " AK"         7
##  2 " AL"         3
##  3 " AR"         2
##  4 " AZ"        11
##  5 " CA"        39
##  6 " CO"        47
##  7 " CT"         8
##  8 " DC"         1
##  9 " DE"         2
## 10 " FL"        15
## # ... with 41 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{count_wrap <-}\StringTok{ }\KeywordTok{cbind}\NormalTok{(df_count[}\DecValTok{1}\OperatorTok{:}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(df_count)}\OperatorTok{/}\DecValTok{5}\NormalTok{), ], df_count[(}\DecValTok{1}\OperatorTok{+}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(df_count)}\OperatorTok{/}\DecValTok{5}\NormalTok{))}\OperatorTok{:}\NormalTok{(}\DecValTok{10}\OperatorTok{+}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(df_count)}\OperatorTok{/}\DecValTok{5}\NormalTok{)), ], df_count[(}\DecValTok{11}\OperatorTok{+}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(df_count)}\OperatorTok{/}\DecValTok{5}\NormalTok{))}\OperatorTok{:}\NormalTok{(}\DecValTok{20}\OperatorTok{+}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(df_count)}\OperatorTok{/}\DecValTok{5}\NormalTok{)),], df_count[(}\DecValTok{21}\OperatorTok{+}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(df_count)}\OperatorTok{/}\DecValTok{5}\NormalTok{))}\OperatorTok{:}\NormalTok{(}\DecValTok{30}\OperatorTok{+}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(df_count)}\OperatorTok{/}\DecValTok{5}\NormalTok{)),], df_count[(}\DecValTok{31}\OperatorTok{+}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(df_count)}\OperatorTok{/}\DecValTok{5}\NormalTok{))}\OperatorTok{:}\NormalTok{(}\DecValTok{40}\OperatorTok{+}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(df_count)}\OperatorTok{/}\DecValTok{5}\NormalTok{)),])}

\NormalTok{count_wrap }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    State Breweries State Breweries State Breweries State Breweries State
## 1     AK         7    GA         7    MD         7    NH         3    SC
## 2     AL         3    HI         4    ME         9    NJ         3    SD
## 3     AR         2    IA         5    MI        32    NM         4    TN
## 4     AZ        11    ID         5    MN        12    NV         2    TX
## 5     CA        39    IL        18    MO         9    NY        16    UT
## 6     CO        47    IN        22    MS         2    OH        15    VA
## 7     CT         8    KS         3    MT         9    OK         6    VT
## 8     DC         1    KY         4    NC        19    OR        29    WA
## 9     DE         2    LA         5    ND         1    PA        25    WI
## 10    FL        15    MA        23    NE         5    RI         5    WV
##    Breweries
## 1          4
## 2          1
## 3          3
## 4         28
## 5          4
## 6         16
## 7         10
## 8         23
## 9         20
## 10         1
\end{verbatim}

\hypertarget{merge-beer-data-with-breweries-data-by-brewery-id.-print-rst-6-observations-and-the-last-six-observations-to-check-the-merged-le.}{%
\paragraph{2. Merge beer data with breweries data by brewery id. Print
ﬁrst 6 observations and the last six observations to check the merged
ﬁle.}\label{merge-beer-data-with-breweries-data-by-brewery-id.-print-rst-6-observations-and-the-last-six-observations-to-check-the-merged-le.}}

we merge \texttt{df\_beers} and \texttt{df\_breweries} dataframes by
\texttt{Brewery\_ID} using merge command for base R and assign the new
dataframe to \texttt{df\_breweries\_and\_beer}. We use \texttt{head()}
and \texttt{tail()} to print the first and last 6 rows of the newly
created \texttt{df\_breweries\_and\_beer} dataframe respectively.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#Code}
\CommentTok{# merge two data frames by ID}
\CommentTok{#Code}
\KeywordTok{names}\NormalTok{(df_beers)[}\DecValTok{5}\NormalTok{]<-}\StringTok{ "Brew_ID"} \CommentTok{#making the merged columns the same}
\NormalTok{df_breweries_and_beer <-}\StringTok{ }\KeywordTok{merge}\NormalTok{(df_beers, df_breweries, }\DataTypeTok{by=}\StringTok{"Brew_ID"}\NormalTok{)}
\KeywordTok{names}\NormalTok{(df_breweries_and_beer)[}\DecValTok{2}\NormalTok{] <-}\StringTok{ "BeerName"} \CommentTok{#changing name.x to BeerName}
\KeywordTok{names}\NormalTok{(df_breweries_and_beer)[}\DecValTok{8}\NormalTok{] <-}\StringTok{ "BreweryName"} \CommentTok{#changing name.y to BreweryName}
\KeywordTok{head}\NormalTok{(df_breweries_and_beer, }\DecValTok{6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Brew_ID      BeerName Beer_ID   ABV IBU
## 1       1  Get Together    2692 0.045  50
## 2       1 Maggie's Leap    2691 0.049  26
## 3       1    Wall's End    2690 0.048  19
## 4       1       Pumpion    2689 0.060  38
## 5       1    Stronghold    2688 0.060  25
## 6       1   Parapet ESB    2687 0.056  47
##                                 Style Ounces        BreweryName
## 1                        American IPA     16 NorthGate Brewing 
## 2                  Milk / Sweet Stout     16 NorthGate Brewing 
## 3                   English Brown Ale     16 NorthGate Brewing 
## 4                         Pumpkin Ale     16 NorthGate Brewing 
## 5                     American Porter     16 NorthGate Brewing 
## 6 Extra Special / Strong Bitter (ESB)     16 NorthGate Brewing 
##          City State
## 1 Minneapolis    MN
## 2 Minneapolis    MN
## 3 Minneapolis    MN
## 4 Minneapolis    MN
## 5 Minneapolis    MN
## 6 Minneapolis    MN
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{tail}\NormalTok{(df_breweries_and_beer, }\DecValTok{6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      Brew_ID                  BeerName Beer_ID   ABV IBU
## 2405     556             Pilsner Ukiah      98 0.055  NA
## 2406     557  Heinnieweisse Weissebier      52 0.049  NA
## 2407     557           Snapperhead IPA      51 0.068  NA
## 2408     557         Moo Thunder Stout      50 0.049  NA
## 2409     557         Porkslap Pale Ale      49 0.043  NA
## 2410     558 Urban Wilderness Pale Ale      30 0.049  NA
##                        Style Ounces                   BreweryName
## 2405         German Pilsener     12         Ukiah Brewing Company
## 2406              Hefeweizen     12       Butternuts Beer and Ale
## 2407            American IPA     12       Butternuts Beer and Ale
## 2408      Milk / Sweet Stout     12       Butternuts Beer and Ale
## 2409 American Pale Ale (APA)     12       Butternuts Beer and Ale
## 2410        English Pale Ale     12 Sleeping Lady Brewing Company
##               City State
## 2405         Ukiah    CA
## 2406 Garrattsville    NY
## 2407 Garrattsville    NY
## 2408 Garrattsville    NY
## 2409 Garrattsville    NY
## 2410     Anchorage    AK
\end{verbatim}

\hypertarget{address-the-missing-values-in-each-column.}{%
\paragraph{3. Address the missing values in each
column.}\label{address-the-missing-values-in-each-column.}}

as shown in the code block below returns the summary of the number of
NA's per column. International Bitterness Units of beer (IBU) has the
highest number of NA's of all the available variables which is 1005.

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{10}\NormalTok{)\{}
  \KeywordTok{print}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\KeywordTok{names}\NormalTok{(df_breweries_and_beer)[i],}\StringTok{":"}\NormalTok{, }\KeywordTok{sum}\NormalTok{(}\KeywordTok{is.na}\NormalTok{(df_breweries_and_beer[,i]))))\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Brew_ID : 0"
## [1] "BeerName : 0"
## [1] "Beer_ID : 0"
## [1] "ABV : 62"
## [1] "IBU : 1005"
## [1] "Style : 5"
## [1] "Ounces : 0"
## [1] "BreweryName : 0"
## [1] "City : 0"
## [1] "State : 0"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df_breweries_and_beer_clean <-}\StringTok{ }\KeywordTok{na.omit}\NormalTok{(df_breweries_and_beer)}
\end{Highlighting}
\end{Shaded}

\hypertarget{compute-the-median-alcohol-content-and-international-bitterness-unit-for-each-state.-plot-a-bar-chart-to-compare.}{%
\paragraph{4. Compute the median alcohol content and international
bitterness unit for each state. Plot a bar chart to
compare.}\label{compute-the-median-alcohol-content-and-international-bitterness-unit-for-each-state.-plot-a-bar-chart-to-compare.}}

This code block then computes the median alcohol content(ABV) per state
and stores the result in vector \texttt{abv}. It also computes median
International Bitterness Units of the beer (IBU) and stores the result
in \texttt{ibu}. Then plots a grid bar charts to comparing median ABV
and median IBU in each of the 51 States.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#Code}
\NormalTok{abv <-}\StringTok{ }\KeywordTok{tapply}\NormalTok{(df_breweries_and_beer}\OperatorTok{$}\NormalTok{ABV, df_breweries_and_beer}\OperatorTok{$}\NormalTok{State, }\DataTypeTok{FUN=}\NormalTok{median, }\DataTypeTok{na.rm=}\OtherTok{TRUE}\NormalTok{)}
\NormalTok{abv}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     AK     AL     AR     AZ     CA     CO     CT     DC     DE     FL 
## 0.0560 0.0600 0.0520 0.0550 0.0580 0.0605 0.0600 0.0625 0.0550 0.0570 
##     GA     HI     IA     ID     IL     IN     KS     KY     LA     MA 
## 0.0550 0.0540 0.0555 0.0565 0.0580 0.0580 0.0500 0.0625 0.0520 0.0540 
##     MD     ME     MI     MN     MO     MS     MT     NC     ND     NE 
## 0.0580 0.0510 0.0620 0.0560 0.0520 0.0580 0.0550 0.0570 0.0500 0.0560 
##     NH     NJ     NM     NV     NY     OH     OK     OR     PA     RI 
## 0.0550 0.0460 0.0620 0.0600 0.0550 0.0580 0.0600 0.0560 0.0570 0.0550 
##     SC     SD     TN     TX     UT     VA     VT     WA     WI     WV 
## 0.0550 0.0600 0.0570 0.0550 0.0400 0.0565 0.0550 0.0555 0.0520 0.0620 
##     WY 
## 0.0500
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ibu <-}\StringTok{ }\KeywordTok{tapply}\NormalTok{(df_breweries_and_beer}\OperatorTok{$}\NormalTok{IBU, df_breweries_and_beer}\OperatorTok{$}\NormalTok{State, }\DataTypeTok{FUN=}\NormalTok{median, }\DataTypeTok{na.rm=}\OtherTok{TRUE}\NormalTok{)}
\NormalTok{ibu}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   AK   AL   AR   AZ   CA   CO   CT   DC   DE   FL   GA   HI   IA   ID   IL 
## 46.0 43.0 39.0 20.5 42.0 40.0 29.0 47.5 52.0 55.0 55.0 22.5 26.0 39.0 30.0 
##   IN   KS   KY   LA   MA   MD   ME   MI   MN   MO   MS   MT   NC   ND   NE 
## 33.0 20.0 31.5 31.5 35.0 29.0 61.0 35.0 44.5 24.0 45.0 40.0 33.5 32.0 35.0 
##   NH   NJ   NM   NV   NY   OH   OK   OR   PA   RI   SC   SD   TN   TX   UT 
## 48.5 34.5 51.0 41.0 47.0 40.0 35.0 40.0 30.0 24.0 30.0   NA 37.0 33.0 34.0 
##   VA   VT   WA   WI   WV   WY 
## 42.0 30.0 38.0 19.0 57.5 21.0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{states <-}\StringTok{ }\NormalTok{df_count[,}\DecValTok{1}\NormalTok{]}
\NormalTok{abv_percent <-}\StringTok{ }\NormalTok{abv}\OperatorTok{*}\DecValTok{100} \CommentTok{#making these values percents so that the comparisons are easier to see on the graph}
\KeywordTok{head}\NormalTok{(abv_percent)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   AK   AL   AR   AZ   CA   CO 
## 5.60 6.00 5.20 5.50 5.80 6.05
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{medians <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(ibu,abv_percent)}
\CommentTok{#medians}
\NormalTok{ibu_abv <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\KeywordTok{c}\NormalTok{(medians}\OperatorTok{$}\NormalTok{ibu,medians}\OperatorTok{$}\NormalTok{abv),states)}
\KeywordTok{names}\NormalTok{(ibu_abv)[}\DecValTok{1}\NormalTok{] <-}\StringTok{ "Medians"}
\NormalTok{ibu_abv}\OperatorTok{$}\NormalTok{Measure <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\KeywordTok{rep}\NormalTok{(}\StringTok{"IBU"}\NormalTok{,}\KeywordTok{length}\NormalTok{(ibu)),}\KeywordTok{rep}\NormalTok{(}\StringTok{"ABV"}\NormalTok{,}\KeywordTok{length}\NormalTok{(abv)))}
\NormalTok{ibu_abv}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     Medians State Measure
## 1     46.00    AK     IBU
## 2     43.00    AL     IBU
## 3     39.00    AR     IBU
## 4     20.50    AZ     IBU
## 5     42.00    CA     IBU
## 6     40.00    CO     IBU
## 7     29.00    CT     IBU
## 8     47.50    DC     IBU
## 9     52.00    DE     IBU
## 10    55.00    FL     IBU
## 11    55.00    GA     IBU
## 12    22.50    HI     IBU
## 13    26.00    IA     IBU
## 14    39.00    ID     IBU
## 15    30.00    IL     IBU
## 16    33.00    IN     IBU
## 17    20.00    KS     IBU
## 18    31.50    KY     IBU
## 19    31.50    LA     IBU
## 20    35.00    MA     IBU
## 21    29.00    MD     IBU
## 22    61.00    ME     IBU
## 23    35.00    MI     IBU
## 24    44.50    MN     IBU
## 25    24.00    MO     IBU
## 26    45.00    MS     IBU
## 27    40.00    MT     IBU
## 28    33.50    NC     IBU
## 29    32.00    ND     IBU
## 30    35.00    NE     IBU
## 31    48.50    NH     IBU
## 32    34.50    NJ     IBU
## 33    51.00    NM     IBU
## 34    41.00    NV     IBU
## 35    47.00    NY     IBU
## 36    40.00    OH     IBU
## 37    35.00    OK     IBU
## 38    40.00    OR     IBU
## 39    30.00    PA     IBU
## 40    24.00    RI     IBU
## 41    30.00    SC     IBU
## 42       NA    SD     IBU
## 43    37.00    TN     IBU
## 44    33.00    TX     IBU
## 45    34.00    UT     IBU
## 46    42.00    VA     IBU
## 47    30.00    VT     IBU
## 48    38.00    WA     IBU
## 49    19.00    WI     IBU
## 50    57.50    WV     IBU
## 51    21.00    WY     IBU
## 52     5.60    AK     ABV
## 53     6.00    AL     ABV
## 54     5.20    AR     ABV
## 55     5.50    AZ     ABV
## 56     5.80    CA     ABV
## 57     6.05    CO     ABV
## 58     6.00    CT     ABV
## 59     6.25    DC     ABV
## 60     5.50    DE     ABV
## 61     5.70    FL     ABV
## 62     5.50    GA     ABV
## 63     5.40    HI     ABV
## 64     5.55    IA     ABV
## 65     5.65    ID     ABV
## 66     5.80    IL     ABV
## 67     5.80    IN     ABV
## 68     5.00    KS     ABV
## 69     6.25    KY     ABV
## 70     5.20    LA     ABV
## 71     5.40    MA     ABV
## 72     5.80    MD     ABV
## 73     5.10    ME     ABV
## 74     6.20    MI     ABV
## 75     5.60    MN     ABV
## 76     5.20    MO     ABV
## 77     5.80    MS     ABV
## 78     5.50    MT     ABV
## 79     5.70    NC     ABV
## 80     5.00    ND     ABV
## 81     5.60    NE     ABV
## 82     5.50    NH     ABV
## 83     4.60    NJ     ABV
## 84     6.20    NM     ABV
## 85     6.00    NV     ABV
## 86     5.50    NY     ABV
## 87     5.80    OH     ABV
## 88     6.00    OK     ABV
## 89     5.60    OR     ABV
## 90     5.70    PA     ABV
## 91     5.50    RI     ABV
## 92     5.50    SC     ABV
## 93     6.00    SD     ABV
## 94     5.70    TN     ABV
## 95     5.50    TX     ABV
## 96     4.00    UT     ABV
## 97     5.65    VA     ABV
## 98     5.50    VT     ABV
## 99     5.55    WA     ABV
## 100    5.20    WI     ABV
## 101    6.20    WV     ABV
## 102    5.00    WY     ABV
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggplot}\NormalTok{(ibu_abv,}\KeywordTok{aes}\NormalTok{(State,Medians)) }\OperatorTok{+}\StringTok{ }\KeywordTok{geom_bar}\NormalTok{(}\KeywordTok{aes}\NormalTok{(State,Medians, }\DataTypeTok{fill=}\NormalTok{Measure),}\DataTypeTok{stat=}\StringTok{"identity"}\NormalTok{,}\DataTypeTok{position=}\StringTok{"dodge"}\NormalTok{,}\DataTypeTok{width=}\NormalTok{.}\DecValTok{7}\NormalTok{)}\OperatorTok{+}\KeywordTok{scale_fill_manual}\NormalTok{(}\StringTok{"Medians}\CharTok{\textbackslash{}n}\StringTok{"}\NormalTok{, }\DataTypeTok{values=}\KeywordTok{c}\NormalTok{(}\StringTok{"red"}\NormalTok{,}\StringTok{"blue"}\NormalTok{), }\DataTypeTok{labels=}\KeywordTok{c}\NormalTok{(}\StringTok{"ABV"}\NormalTok{,}\StringTok{"IBU"}\NormalTok{)) }\OperatorTok{+}\StringTok{ }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{x=}\StringTok{"}\CharTok{\textbackslash{}n}\StringTok{States"}\NormalTok{,}\DataTypeTok{y=}\StringTok{"Medians}\CharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}\OperatorTok{+}\StringTok{ }\KeywordTok{theme_bw}\NormalTok{(}\DataTypeTok{base_size=}\DecValTok{14}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{axis.text.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{angle=}\DecValTok{90}\NormalTok{,}\DataTypeTok{hjust=}\DecValTok{1}\NormalTok{,}\DataTypeTok{size=}\DecValTok{7}\NormalTok{)) }\OperatorTok{+}\StringTok{ }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Comparing Medians of ABV and IBU"}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Removed 1 rows containing missing values (geom_bar).
\end{verbatim}

\includegraphics{Case_Study_1-.1_files/figure-latex/unnamed-chunk-6-1.pdf}

\hypertarget{which-state-has-the-maximum-alcoholic-abv-beer-which-state-has-the-most-bitter-ibu-beer}{%
\paragraph{5. Which state has the maximum alcoholic (ABV) beer? Which
state has the most bitter (IBU)
beer?}\label{which-state-has-the-maximum-alcoholic-abv-beer-which-state-has-the-most-bitter-ibu-beer}}

In this code block, we identify Kentucky(KY) as the State with the
maximum alcoholic beer with an \texttt{ABV} of \emph{0.125} and Oregon
(OR) as the state with the most bitter beer with an \texttt{IBU} of
\emph{138}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Code}
\CommentTok{#maximum alcoholic beer}
\CommentTok{# select the row with max ABV}
\NormalTok{df_max_abv<-}\KeywordTok{data.frame}\NormalTok{(df_breweries_and_beer_clean[}\KeywordTok{which}\NormalTok{(df_breweries_and_beer_clean}\OperatorTok{$}\NormalTok{ABV}\OperatorTok{==}\KeywordTok{max}\NormalTok{(df_breweries_and_beer_clean}\OperatorTok{$}\NormalTok{ABV)),])}

\KeywordTok{print}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(}\StringTok{"The state with the beer with maximum alcohol is ->"}\NormalTok{, df_max_abv}\OperatorTok{$}\NormalTok{State, }\StringTok{" with an ABV of "}\NormalTok{, df_max_abv}\OperatorTok{$}\NormalTok{ABV)) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "The state with the beer with maximum alcohol is -> KY with an ABV of 0.125"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# print the state with Max alcoholic beer }

\CommentTok{#state with the most bitter beer}
\CommentTok{# select the row with max IBU}
\NormalTok{df_max_ibu<-}\KeywordTok{data.frame}\NormalTok{(df_breweries_and_beer_clean[}\KeywordTok{which}\NormalTok{(df_breweries_and_beer_clean}\OperatorTok{$}\NormalTok{IBU}\OperatorTok{==}\KeywordTok{max}\NormalTok{(df_breweries_and_beer_clean}\OperatorTok{$}\NormalTok{IBU)),]) }

\KeywordTok{print}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(}\StringTok{"The state with Most bitter beer is ->"}\NormalTok{, df_max_ibu}\OperatorTok{$}\NormalTok{State, }\StringTok{" with IBU of "}\NormalTok{, df_max_ibu}\OperatorTok{$}\NormalTok{IBU)) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "The state with Most bitter beer is -> OR with IBU of 138"
\end{verbatim}

\hypertarget{comment-on-the-summary-statistics-and-distribution-of-the-abv-variable.}{%
\paragraph{6. Comment on the summary statistics and distribution of the
ABV
variable.}\label{comment-on-the-summary-statistics-and-distribution-of-the-abv-variable.}}

To get the summary statistics of ABV by Volume variable, we are using
summary function.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#Code}
\KeywordTok{summary}\NormalTok{(df_breweries_and_beer_clean}\OperatorTok{$}\NormalTok{ABV)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## 0.02700 0.05000 0.05700 0.05992 0.06800 0.12500
\end{verbatim}

\hypertarget{is-there-an-apparent-relationship-between-the-bitterness-of-the-beer-and-its-alcoholic-content-draw-a-scatter-plot.-make-your-best-judgment-of-a-relationship-and-explain-your-answer.}{%
\paragraph{7. Is there an apparent relationship between the bitterness
of the beer and its alcoholic content? Draw a scatter plot. Make your
best judgment of a relationship and EXPLAIN your
answer.}\label{is-there-an-apparent-relationship-between-the-bitterness-of-the-beer-and-its-alcoholic-content-draw-a-scatter-plot.-make-your-best-judgment-of-a-relationship-and-explain-your-answer.}}

There is a positive correlation between \texttt{ABV} and \texttt{IBU} as
shown in the regression trend line in the scatter plot below.
\texttt{IBU} increases with an increase in \texttt{ABV}.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggplot}\NormalTok{(df_breweries_and_beer, }\KeywordTok{aes}\NormalTok{(df_breweries_and_beer}\OperatorTok{$}\NormalTok{IBU, df_breweries_and_beer}\OperatorTok{$}\NormalTok{ABV)) }\OperatorTok{+}\StringTok{ }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{color =}\NormalTok{ (}\StringTok{"red"}\NormalTok{) , }\DataTypeTok{na.rm=}\OtherTok{TRUE}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{title =} \StringTok{"International Bitterness Unit (IBU) vs Alcohol by Volume (ABV)"}\NormalTok{, }\DataTypeTok{x =} \StringTok{"IBU"}\NormalTok{, }\DataTypeTok{y =}\StringTok{"ABV"}\NormalTok{) }\OperatorTok{+}\KeywordTok{theme}\NormalTok{(}\DataTypeTok{plot.title =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{hjust =} \FloatTok{0.5}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{Case_Study_1-.1_files/figure-latex/unnamed-chunk-9-1.pdf}


\end{document}
